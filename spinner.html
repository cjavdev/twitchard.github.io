<!DOCTYPE HTML>
<html>
<head>
  <title>SVG Spinner</title>
	<style type="text/css">
		* {
			font-family: Arial, sans-serif;
		}
		#wrapper {
			width: 400px;
			text-align: center;
		} 
		#button-holder {
			width: 200px;
			margin: auto;
		}
		#spinner-button {
			width: 200px;
			height: 75px;
			font-size: 1.25em;
			font-weight: bold;
		}
	</style>
	<script type="text/javascript">	
                var names =
                    [ 'penelope', // 0
                      'helen', // 1
                      'persephone', // 2
                      'taylor swift', // 3
                    ]

                var winner = 2
		var svgns = "http://www.w3.org/2000/svg"; // SVG Namespace (in case we need it)
		var slices = []; // Array of wheel slice objects
		var numSlices = names.length;  // Size of the circle slices
		var isSpinning = false; // Is the arrow spinning?
		var rotation = 0; // Arrow rotation
		var currentSlice = 0; // Current slice the arrow is over
		var wheel; // DOM Object for the spinner board
		var arrow; // DOM Object for the spinner arrow
		var spinButton; // DOM Object for the spin wheel <button>
		
                var fromCenter = "60"
		// Basic wheel "slice" object for drawing SVG
		function Slice(num, parent) {
			// Set instance vars
			this.parent = parent;
			this.size = 360/numSlices;
			this.offset = num * this.size;
                        this.num = num
			this.id = "slice_"+num;
                        this.name = names[num]
			// Draw the object
			this.object = this.create();
			this.parent.appendChild(this.object);
		}
		Slice.prototype = {
			create:function() {
				// Create a group to store the slice in
				var g = document.createElementNS(svgns, "g");
				// Create the slice object
				var slice = document.createElementNS(svgns, "path");
				slice.setAttributeNS(null, "id", this.id);
				var x1 = 200 + 160 * Math.cos(Math.PI*(-90+this.offset)/180);
				var y1 = 200 + 160 * Math.sin(Math.PI*(-90+this.offset)/180);
				var x2 = 200 + 160 * Math.cos(Math.PI*(-90+this.size+this.offset)/180);
				var y2 = 200 + 160 * Math.sin(Math.PI*(-90+this.size+this.offset)/180);
				slice.setAttributeNS(null, "d", "M 200 200 L "+x1+" "+y1+" A 130 130 0 0 1 "+x2+" "+y2+"  Z");
				// Randomize the color of the slice and finish styling
				var hue = Math.floor((this.num * 117 % numSlices) * this.size) + 20;
				slice.setAttributeNS(null, "fill", "hsl("+hue+", 100% , 30%)");
				slice.setAttributeNS(null, "stroke", "#222222");
				slice.setAttributeNS(null, "style", "stroke-width:2px");
				// Add the slice to the group
				g.appendChild(slice);
				// Create the highlight for the slice
                                var label = document.createElementNS(svgns, "text")
                                label.innerHTML=this.name
                                label.setAttributeNS(null, "fill", "white")
                                label.setAttributeNS(null, "style", "font-size:16pt")
                                label.setAttributeNS(null, "x", 200)
                                label.setAttributeNS(null, "y", 200)
                                label.setAttributeNS(null, "transform", 
                                    "rotate( " + (-90 + this.offset + (this.size/2) + 2) + "," + 200 + "," + 200 + ")" +
                                    "translate(" + fromCenter + ", 0)"
                                    
                                )
                                g.appendChild(label)
				return g;
			},
		};
		// Toggle the spinning of the wheel
		function toggleSpinning() {
			// Toggle the spinning animation
			if (isSpinning) {
				// Stop the arrow
				isSpinning = false;
				clearInterval(toggleSpinning.spinInt);
				spinButton.removeAttribute("disabled");
			}
			else {
				// Start spinning the arrow
				isSpinning = true;
				toggleSpinning.spinInt = setInterval(spinWheel, 10);
				// Set how long the wheel will be spinning
				var duration = 3000;
				setTimeout(toggleSpinning, duration);
				// Disable the spin button
				spinButton.setAttribute("disabled", "true");
			}
		}
		// Animation step for spinning the wheel arrow
		function spinWheel() {
			// Rotate the spinner arrow
			rotation = (rotation + 12) % 360;
			arrow.setAttributeNS(null, "transform", "rotate("+rotation+",200,200)");
			// Highlight the slice the arrow is above
			var newSlice = Math.floor(rotation / (360/numSlices));
			if (newSlice != currentSlice) {
				slices[currentSlice].toggleOverlay();
				slices[newSlice].toggleOverlay();
				currentSlice = newSlice;
			}
		}
		// Document ready event
		document.addEventListener("DOMContentLoaded", function() {
			// Get a handle to all necessary DOM elements
			wheel = document.getElementById("spinner-board"); // DOM Object for the spinner board
			arrow = document.getElementById("spinner-arrow"); // DOM Object for the spinner arrow
			spinButton = document.getElementById("spinner-button"); // DOM Object for the spin wheel <button>
			// Generate the wheel sections
			for (var i = 0; i < numSlices; i++) {
				slices[i] = new Slice(i, wheel);
			}
			// Highlight the first slice
			slices[0].toggleOverlay();
		}, false);
	</script>
</head>
<body>
<div id="wrapper">
	<svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="400" height="400">
		<circle cx="200" cy="200" r="130" fill="#222222"/>
		<g id="spinner-board"></g>
		<path id="spinner-arrow" d="M 195 200 L 195 140 L 188 140 L 200 125 L 212 140 L 205 140 205 200 Z" fill="#EEEEEE" stroke="#222222" style="stroke-width:2px"/>
		<circle cx="200" cy="200" r="18" fill="#444444" stroke="#222222" style="stroke-width:2px"/>
		<circle cx="200" cy="200" r="9" fill="#666666" stroke="#222222" style="stroke-width:2px"/>
	</svg>
	<div id="button-holder">
		<button id="spinner-button" onclick="toggleSpinning();">Start the Spinner!</button>
	</div>
</div>
</body>
</html>
